<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>16.2. Silver/gold alloy &mdash; Demeter Programming Guide 0.9.24 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.24',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/wheat.ico"/>
    <link rel="top" title="Demeter Programming Guide 0.9.24 documentation" href="../index.html" />
    <link rel="up" title="16. Full examples" href="index.html" />
    <link rel="next" title="16.3. Uranyl ion in solution" href="uranyl.html" />
    <link rel="prev" title="16.1. Methyltin chloride" href="methyltin.html" />

    <link rel="stylesheet" type="text/css" href="../_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="../_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="../_static/program.css" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="uranyl.html" title="16.3. Uranyl ion in solution"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="methyltin.html" title="16.1. Methyltin chloride"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Demeter Programming Guide 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">16. Full examples</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="silver-gold-alloy">
<h1>16.2. Silver/gold alloy<a class="headerlink" href="#silver-gold-alloy" title="Permalink to this headline">¶</a></h1>
<p>Topics demonstrated</p>
<ul class="simple">
<li>Multiple data set fitting</li>
<li>using the characteristic value</li>
</ul>
<p>In this example, a series of silver/gold alloys are co-refined using a
simple model in which the first shell is a mixture of silver and gold
backscatterers in the same proportion as the bulk. This example lends
itself quite naturally to using the <a class="reference external" href="../lgcv.html">characteristic
value</a> of the Data object. It also demonstrates a
direct manipulation of a Feff object without editing a feff.inp file.</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
<<<<<<< HEAD
113</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">#!/usr/bin/perl</span>
=======
113</pre></div></td><td class="code"><div class="highlight"><pre> <span class="c1">#!/usr/bin/perl</span>
>>>>>>> 753331e6a97ab20b2d74045d9da536a4dde339ea
 <span class="k">use</span> <span class="n">Demeter</span> <span class="sx">qw(:ui=screen :plotwith=gnuplot)</span><span class="p">;</span>
 <span class="k">print</span> <span class="s">&quot;Multiple data set fit to several AgAu samples using Demeter $Demeter::VERSION\n&quot;</span><span class="p">;</span>

 <span class="c1">### -------- import five sets of Ag and Ag/Au data from an Athena project file</span>
 <span class="k">my</span> <span class="nv">$prj</span> <span class="o">=</span> <span class="nn">Demeter::Data::</span><span class="n">Prj</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span><span class="n">file</span> <span class="o">=&gt;</span> <span class="s">&#39;AgAu_merged.prj&#39;</span><span class="p">);</span>
 <span class="nv">$prj</span> <span class="o">-&gt;</span> <span class="n">set_mode</span><span class="p">(</span><span class="n">screen</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">backend</span><span class="o">=&gt;</span><span class="mi">1</span><span class="p">);</span>
 <span class="k">my</span> <span class="nv">@common</span> <span class="o">=</span> <span class="p">(</span><span class="n">fft_kmin</span>  <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>   <span class="n">fft_kmax</span>  <span class="o">=&gt;</span> <span class="mi">11</span><span class="p">,</span>
               <span class="n">bft_rmax</span>  <span class="o">=&gt;</span> <span class="mf">3.2</span><span class="p">,</span> <span class="n">bft_rmin</span>  <span class="o">=&gt;</span> <span class="mf">1.8</span><span class="p">,</span>
               <span class="n">fit_k1</span>    <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>   <span class="n">fit_k2</span>    <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>    <span class="n">fit_k3</span>    <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,);</span>
 <span class="k">my</span> <span class="nv">$data_100</span> <span class="o">=</span> <span class="nv">$prj</span><span class="o">-&gt;</span><span class="n">record</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
 <span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="nv">@common</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>   <span class="n">name</span> <span class="o">=&gt;</span> <span class="s">&#39;pure silver&#39;</span><span class="p">);</span>

 <span class="k">my</span> <span class="nv">$data_80</span> <span class="o">=</span> <span class="nv">$prj</span><span class="o">-&gt;</span><span class="n">record</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
 <span class="nv">$data_80</span>  <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="nv">@common</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=&gt;</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">name</span> <span class="o">=&gt;</span> <span class="s">&#39;80% silver&#39;</span><span class="p">);</span>

 <span class="k">my</span> <span class="nv">$data_60</span> <span class="o">=</span> <span class="nv">$prj</span><span class="o">-&gt;</span><span class="n">record</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
 <span class="nv">$data_60</span>  <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="nv">@common</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=&gt;</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">name</span> <span class="o">=&gt;</span> <span class="s">&#39;60% silver&#39;</span><span class="p">);</span>

 <span class="k">my</span> <span class="nv">$data_50</span> <span class="o">=</span> <span class="nv">$prj</span><span class="o">-&gt;</span><span class="n">record</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
 <span class="nv">$data_50</span>  <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="nv">@common</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span> <span class="o">=&gt;</span> <span class="s">&#39;50% silver&#39;</span><span class="p">);</span>

 <span class="k">my</span> <span class="nv">$data_40</span> <span class="o">=</span> <span class="nv">$prj</span><span class="o">-&gt;</span><span class="n">record</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
 <span class="nv">$data_40</span>  <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="nv">@common</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=&gt;</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">name</span> <span class="o">=&gt;</span> <span class="s">&#39;40% silver&#39;</span><span class="p">);</span>

 <span class="c1">## -------- make GDS objects for an isotropic expansion, correlated</span>
 <span class="c1">##          Debye, mixed first shell fit to silver and silver/gold</span>
 <span class="k">my</span> <span class="nv">@gdsobjects</span> <span class="o">=</span>  <span class="p">(</span><span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">simpleGDS</span><span class="p">(</span><span class="s">&quot;guess amp   = 1&quot;</span><span class="p">),</span>
                    <span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">simpleGDS</span><span class="p">(</span><span class="s">&quot;guess enot  = 0&quot;</span><span class="p">),</span>
                    <span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">simpleGDS</span><span class="p">(</span><span class="s">&quot;guess dr_ag = 0&quot;</span><span class="p">),</span>
                    <span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">simpleGDS</span><span class="p">(</span><span class="s">&quot;guess ss_ag = 0.003&quot;</span><span class="p">),</span>
                    <span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">simpleGDS</span><span class="p">(</span><span class="s">&quot;guess dr_au = 0&quot;</span><span class="p">),</span>
                    <span class="nv">$data_100</span> <span class="o">-&gt;</span> <span class="n">simpleGDS</span><span class="p">(</span><span class="s">&quot;guess ss_au = 0.003&quot;</span><span class="p">),</span>
                    <span class="c1">## Determine Ag::Au ratios with an lguess</span>
                    <span class="c1">## $data_100 -&gt; simpleGDS(&quot;lguess frac = 0.6&quot;),</span>
                   <span class="p">);</span>

 <span class="c1">## -------- import Ag crystal data and generate a feff.inp file</span>
 <span class="k">my</span> <span class="nv">$atoms</span> <span class="o">=</span> <span class="nn">Demeter::</span><span class="n">Atoms</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span><span class="n">file</span> <span class="o">=&gt;</span> <span class="s">&quot;Ag.inp&quot;</span><span class="p">);</span>
 <span class="nb">open</span><span class="p">(</span><span class="k">my</span> <span class="nv">$FEFF</span><span class="p">,</span> <span class="s">&#39;&gt;feff.inp&#39;</span><span class="p">);</span>
 <span class="k">print</span> <span class="nv">$FEFF</span> <span class="nv">$atoms</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">(</span><span class="s">&quot;feff6&quot;</span><span class="p">);</span>
 <span class="nb">close</span> <span class="nv">$FEFF</span><span class="p">;</span>

 <span class="c1">## -------- run Feff on pure silver</span>
 <span class="k">my</span> <span class="nv">$agfeff</span> <span class="o">=</span> <span class="nn">Demeter::</span><span class="n">Feff</span> <span class="o">-&gt;</span> <span class="k">new</span><span class="p">(</span><span class="n">file</span> <span class="o">=&gt;</span> <span class="s">&quot;feff.inp&quot;</span><span class="p">);</span>
 <span class="nv">$agfeff</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="n">workspace</span><span class="o">=&gt;</span><span class="s">&quot;feff/&quot;</span><span class="p">,</span> <span class="n">screen</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,);</span>
 <span class="nv">$agfeff</span> <span class="o">-&gt;</span> <span class="n">make_workspace</span><span class="p">;</span>
 <span class="nv">$agfeff</span> <span class="o">-&gt;</span> <span class="n">run</span><span class="p">;</span>

 <span class="c1">## -------- make a path object from the 1st shell of pure silver, use</span>
 <span class="c1">##          this for the pure silver data</span>
 <span class="k">my</span> <span class="nv">@paths</span> <span class="o">=</span> <span class="p">();</span>
 <span class="nv">$paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nn">Demeter::</span><span class="n">Path</span> <span class="o">-&gt;</span> <span class="k">new</span><span class="p">();</span>
 <span class="nv">$paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">data</span>     <span class="o">=&gt;</span> <span class="nv">$data_100</span><span class="p">,</span>
                <span class="n">parent</span>   <span class="o">=&gt;</span> <span class="nv">$agfeff</span><span class="p">,</span>
                <span class="n">sp</span>       <span class="o">=&gt;</span> <span class="nv">$agfeff</span><span class="o">-&gt;</span><span class="n">pathlist</span><span class="o">-&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">name</span>     <span class="o">=&gt;</span> <span class="s">&#39;silver&#39;</span><span class="p">,</span>
                <span class="n">n</span>        <span class="o">=&gt;</span> <span class="mi">12</span><span class="p">,</span>
                <span class="n">s02</span>      <span class="o">=&gt;</span> <span class="s">&#39;amp&#39;</span><span class="p">,</span>
                <span class="n">e0</span>       <span class="o">=&gt;</span> <span class="s">&#39;enot&#39;</span><span class="p">,</span>
                <span class="n">delr</span>     <span class="o">=&gt;</span> <span class="s">&#39;dr_ag&#39;</span><span class="p">,</span>
                <span class="n">sigma2</span>   <span class="o">=&gt;</span> <span class="s">&#39;ss_ag&#39;</span><span class="p">,</span>
               <span class="p">);</span>

 <span class="c1">## -------- clone the Ag Feff calculation, add Au to the potentials</span>
 <span class="c1">##          list, make an Au scatterer out of the first site after the</span>
 <span class="c1">##          absorber</span>
 <span class="k">my</span> <span class="nv">$aufeff</span> <span class="o">=</span> <span class="nv">$agfeff</span><span class="o">-&gt;</span><span class="n">Clone</span><span class="p">;</span>
 <span class="nv">$aufeff</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="n">workspace</span><span class="o">=&gt;</span><span class="s">&quot;feffau/&quot;</span><span class="p">,</span> <span class="n">screen</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">,);</span>
 <span class="nv">$aufeff</span> <span class="o">-&gt;</span> <span class="n">make_workspace</span><span class="p">;</span>
 <span class="nv">$aufeff</span> <span class="o">-&gt;</span> <span class="n">push_potentials</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="s">&#39;Au&#39;</span><span class="p">]);</span> <span class="c1">## add Au to the end of the potentials list</span>
 <span class="k">my</span> <span class="nv">@sites</span> <span class="o">=</span> <span class="nv">@</span><span class="p">{</span> <span class="nv">$aufeff</span><span class="o">-&gt;</span><span class="n">sites</span> <span class="p">};</span> <span class="c1">## make the first atom after the</span>
 <span class="k">my</span> <span class="nv">@neighbor</span>   <span class="o">=</span> <span class="nv">@</span><span class="p">{</span> <span class="nv">$sites</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">};</span> <span class="c1">## absorber in the sites list an Au</span>
 <span class="nv">@neighbor</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;Au&#39;</span><span class="p">);</span>       <span class="c1">## (this could be easier...)</span>
 <span class="nv">$sites</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>      <span class="o">=</span> <span class="o">\</span><span class="nv">@neighbor</span><span class="p">;</span>
 <span class="nv">$aufeff</span> <span class="o">-&gt;</span> <span class="n">sites</span><span class="p">(</span><span class="o">\</span><span class="nv">@sites</span><span class="p">);</span>
 <span class="nv">$aufeff</span> <span class="o">-&gt;</span> <span class="n">run</span><span class="p">;</span>                 <span class="c1">## and continue</span>

 <span class="c1">## -------- clone the Path object several times, taking care to</span>
 <span class="c1">##          correctly map paths to data sets</span>
 <span class="k">my</span> <span class="nv">%map</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">=&gt;</span><span class="nv">$data_80</span><span class="p">,</span> <span class="mi">4</span><span class="o">=&gt;</span><span class="nv">$data_60</span><span class="p">,</span> <span class="mi">6</span><span class="o">=&gt;</span><span class="nv">$data_50</span><span class="p">,</span> <span class="mi">8</span><span class="o">=&gt;</span><span class="nv">$data_40</span><span class="p">);</span>
 <span class="k">my</span> <span class="nv">%percentage</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">=&gt;</span><span class="s">&#39;80&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="o">=&gt;</span><span class="s">&#39;60&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="o">=&gt;</span><span class="s">&#39;50&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="o">=&gt;</span><span class="s">&#39;40&#39;</span><span class="p">);</span>
 <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$i</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">{</span>       <span class="c1"># clone silver paths</span>
   <span class="k">my</span> <span class="nv">$j</span> <span class="o">=</span> <span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="nv">$paths</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Clone</span><span class="p">(</span><span class="n">data</span>  <span class="o">=&gt;</span> <span class="nv">$map</span><span class="p">{</span><span class="nv">$i</span><span class="p">},</span>
                                 <span class="c1">#s02  =&gt; &quot;amp*frac&quot;,   # lguess</span>
                                 <span class="n">s02</span>   <span class="o">=&gt;</span> <span class="s">&quot;amp*[cv]&quot;</span><span class="p">,</span>   <span class="c1"># char. value</span>
                                <span class="p">);</span>
 <span class="p">};</span>
 <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$i</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">{</span>       <span class="c1"># clone gold paths</span>
   <span class="k">my</span> <span class="nv">$j</span> <span class="o">=</span> <span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="nv">$paths</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$paths</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Clone</span><span class="p">(</span><span class="n">parent</span>  <span class="o">=&gt;</span> <span class="nv">$aufeff</span><span class="p">,</span>
                                  <span class="n">sp</span>      <span class="o">=&gt;</span> <span class="nv">$aufeff</span><span class="o">-&gt;</span><span class="n">find_path</span><span class="p">(</span><span class="n">tag</span><span class="o">=&gt;</span><span class="p">[</span><span class="s">&#39;Au&#39;</span><span class="p">]),</span>
                                  <span class="n">name</span>    <span class="o">=&gt;</span> <span class="s">&quot;gold&quot;</span><span class="p">,</span>
                                  <span class="n">n</span>       <span class="o">=&gt;</span> <span class="mi">12</span><span class="p">,</span>
                                  <span class="c1">#s02    =&gt; &quot;amp*(1-frac)&quot;, # lguess</span>
                                  <span class="n">s02</span>     <span class="o">=&gt;</span> <span class="s">&quot;amp*(1-[cv])&quot;</span><span class="p">,</span> <span class="c1"># char. value</span>
                                  <span class="n">delr</span>    <span class="o">=&gt;</span> <span class="s">&quot;dr_au&quot;</span><span class="p">,</span>
                                  <span class="n">sigma2</span>  <span class="o">=&gt;</span> <span class="s">&quot;ss_au&quot;</span><span class="p">,</span>
                                 <span class="p">);</span>
 <span class="p">};</span>


 <span class="c1">## -------- make a Fit object, which is just a collection of GDS, Data, and Path objects</span>
 <span class="k">my</span> <span class="nv">$fitobject</span> <span class="o">=</span> <span class="nn">Demeter::</span><span class="n">Fit</span> <span class="o">-&gt;</span> <span class="k">new</span><span class="p">;</span>
 <span class="nv">$fitobject</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">gds</span>   <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">@gdsobjects</span><span class="p">,</span>
                 <span class="n">data</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="nv">$data_100</span><span class="p">,</span> <span class="nv">$data_80</span><span class="p">,</span> <span class="nv">$data_60</span><span class="p">,</span> <span class="nv">$data_50</span><span class="p">,</span> <span class="nv">$data_40</span><span class="p">],</span>
                 <span class="n">paths</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">@paths</span>
                <span class="p">);</span>

 <span class="c1">## -------- do the fit</span>
 <span class="nv">$fitobject</span> <span class="o">-&gt;</span> <span class="n">fit</span><span class="p">;</span>
 <span class="nv">$fitobject</span> <span class="o">-&gt;</span> <span class="n">interview</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>An <font size=-1 color="#8C4112">ATHENA</font> project file is imported at line 6. At lines 11
through 24, five of the data sets from the project file are imported
into Data objects. Each one has its <code class="docutils literal"><span class="pre">name</span></code> <code class="docutils literal"><span class="pre">cv</span></code> attributes set
appropriately.  The <code class="docutils literal"><span class="pre">cv</span></code> is set to the bulk fradction of silver in
the sample.</p>
<p>A set of guess parameters is defined at lines 28-33 for a simple
fitting model that includes overall amplitude and E<sub>0</sub>
parameters along with ΔR and σ<sup>2</sup> parameters for
each type of scatterer.</p>
<p>At line 39-42 an <code class="file docutils literal"><span class="pre">atoms.inp</span></code> is imported and a temporary
<code class="file docutils literal"><span class="pre">feff.inp</span></code> is written.  This <code class="file docutils literal"><span class="pre">feff.inp</span></code> is imported,
forming a Feff object at line 45.  Note that the <code class="docutils literal"><span class="pre">run</span></code> method at
line 48 is a wrapper around the <code class="docutils literal"><span class="pre">potph</span></code> and <code class="docutils literal"><span class="pre">pathfinder</span></code> methods.
The first path from this calculation, the one corresponding to the 12
silver atoms in the first coordination shell, is made into a Path
object at lines 53-63. Note the idiomatic dereferencing of the first
ScatteringPath object from the <font size=-1 color="#8C4112">FEFF</font> calculation at
line 56. Note that this Path object points at the Data object for the
pure silver data.</p>
<p>The <font size=-1 color="#8C4112">FEFF</font> calculation for the contribution from the Au
scatterer is obtained at lines 68-77. Here's how it works. First, the
Feff object from the pure silver calculation is cloned at line 68 and
a separate workspace is established at lines 69 and 70. At line 71, a
new potential type is pushed onto the list of potentials of the cloned
Feff object. At lines 72-76, an atom from the first coordination shell
is switched from silver to gold. This modified sites list is then
pushed back into the object.</p>
<p>The manipulations at lines 68-77 represent both a weakness and a great
strength of <font size=-1 color="#8C4112">DEMETER</font>'s interactions with <font size=-1 color="#8C4112">FEFF</font>. On
one hand, <font size=-1 color="#8C4112">DEMETER</font> currently lacks more graceful tools for
making these manipulations. On the other hand, this example
demonstrates the extent to which a <font size=-1 color="#8C4112">FEFF</font> calculation can be
controlled algorithmically. Thus complex modeling chores can be
programed directly rather than prepared on disk beforehand.</p>
<p>At lines 81-101, paths are set up for the four alloy samples. First, at
83-89, the silver path is cloned and assigned to each alloy Data object.
Note that the <a class="reference external" href="../lgcv.html">characteristic value</a> is used to get the
amplitude term set correctly for each alloy Data object. In this case,
the <code class="docutils literal"><span class="pre">cv</span></code> is set to the amount of silver in each sample. When the
<code class="docutils literal"><span class="pre">[cv]</span></code> token is resolved, each silver path will have its amplitude set
properly.</p>
<p>At lines 90-101, more paths are cloned, then modified to use the
ScatteringPath object which corresponds to the gold scatterer from the
second <font size=-1 color="#8C4112">FEFF</font> calculation. Again, care is taken to make sure
that the correct Path object, with the correct <code class="docutils literal"><span class="pre">cv</span></code> value, is
associated with the correct Data object. Note the use of the
<code class="docutils literal"><span class="pre">find_path</span></code> method at line 93. This identifies the ScatteringPath
object using a <a class="reference external" href="../paths/semantic.html">semantic path description</a>.
This simplifies the chore of finding the correct ScatteringPath
without needing to keep track of the order of scattering paths in the
<font size=-1 color="#8C4112">FEFF</font> calculation.</p>
<p>Finally, the Fit object is created and the fit is run. Finally, the
<code class="docutils literal"><span class="pre">interview</span></code> method is called so the fit can be examined interactively
from a command line script.</p>
<div class="figure align-center" id="id1">
<span id="fig-agaufit"></span><a class="reference external image-reference" href="../_images/agau_fit.png"><img alt="../_images/agau_fit.png" src="../_images/agau_fit.png" /></a>
<p class="caption"><span class="caption-number">Fig. 16.3 </span><span class="caption-text">Fit to the ensemble of Ag/Au alloy data.</span></p>
</div>
<p>The lines below replaced the <code class="docutils literal"><span class="pre">interview</span></code> method to produce this
plot of the result of the fit:</p>
<<<<<<< HEAD
<div class="highlight-perl"><div class="highlight"><pre><span></span><span class="nv">$fitobject</span> <span class="o">-&gt;</span> <span class="n">po</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="n">plot_fit</span> <span class="o">=&gt;</span>  <span class="mi">1</span><span class="p">,</span>
=======
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">$fitobject</span> <span class="o">-&gt;</span> <span class="n">po</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">(</span><span class="n">plot_fit</span> <span class="o">=&gt;</span>  <span class="mi">1</span><span class="p">,</span>
>>>>>>> 753331e6a97ab20b2d74045d9da536a4dde339ea
                        <span class="n">r_pl</span>     <span class="o">=&gt;</span> <span class="s">&#39;m&#39;</span><span class="p">,</span>
                        <span class="n">kweight</span>  <span class="o">=&gt;</span>  <span class="mi">2</span><span class="p">);</span>
<span class="nv">$data_100</span>  <span class="o">-&gt;</span> <span class="n">y_offset</span><span class="p">(</span><span class="mf">2.0</span><span class="p">);</span>
<span class="nv">$data_100</span>  <span class="o">-&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">);</span>

<span class="nv">$data_80</span>   <span class="o">-&gt;</span> <span class="n">y_offset</span><span class="p">(</span><span class="mf">1.5</span><span class="p">);</span>
<span class="nv">$data_80</span>   <span class="o">-&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">);</span>

<span class="nv">$data_60</span>   <span class="o">-&gt;</span> <span class="n">y_offset</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="nv">$data_60</span>   <span class="o">-&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">);</span>

<span class="nv">$data_50</span>   <span class="o">-&gt;</span> <span class="n">y_offset</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
<span class="nv">$data_50</span>   <span class="o">-&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">);</span>

<span class="nv">$data_40</span>   <span class="o">-&gt;</span> <span class="n">y_offset</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>
<span class="nv">$data_40</span>   <span class="o">-&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">);</span>
<span class="nv">$data_40</span>   <span class="o">-&gt;</span> <span class="n">pause</span><span class="p">;</span>
</pre></div>
</div>
<p>As a final note, the fit presented here assumes that the mixture of
silver and gold in the first coordination shell is of the same ratio as
the nominal bulk mixing ratios. This assumption can be easily relaxed.
By uncommenting lines 35, 86, and 96 and commenting out line 87 and 97,
the fixed mixing ratios are turned into a guess parameter for each data
set using a <a class="reference external" href="../lgcv.html">local guess parameter</a>. In this way, the
lguess is expanded into 5 guess parameters, one for each data set. Try
it!</p>

<br>

<br>
<hr class="docutils" />
<p><font size=-1 color="#8C4112">DEMETER</font> is copyright © 2009-2016 Bruce Ravel – This document is
copyright © 2016 Bruce Ravel</p>
<p>This document is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">The Creative Commons Attribution-ShareAlike License</a>.</p>
<p>If <font size=-1 color="#8C4112">DEMETER</font> and this document are useful to you, please
consider <a class="reference external" href="http://creativecommons.org/support/">supporting The Creative Commons</a>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Isis-Sothis-Demeter_sm.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">2. The basics of data processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mue/index.html">3. Processing μ(E) data</a></li>
<<<<<<< HEAD
<li class="toctree-l1"><a class="reference internal" href="../highlevel/index.html">4. High level actions of the object model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xanes/index.html">5. Analysis of XANES data</a></li>
=======
<li class="toctree-l1"><a class="reference internal" href="../xanes/index.html">4. Analysis of XANES data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../highlevel/index.html">5. High level actions of the object model</a></li>
>>>>>>> 753331e6a97ab20b2d74045d9da536a4dde339ea
<li class="toctree-l1"><a class="reference internal" href="../atoms.html">6. Atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feff/index.html">7. Feff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../paths/index.html">8. Scattering paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gds.html">9. Guess/Def/Set Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fit/index.html">10. Fitting EXAFS data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../perl.html">11. Using perl to structure a fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lgcv.html">12. Local guess parameters and the characteristic value</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pathlike/index.html">13. Path-like objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui.html">14. User interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">15. Output formats</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">16. Full examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="methyltin.html">16.1. Methyltin chloride</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">16.2. Silver/gold alloy</a></li>
<li class="toctree-l2"><a class="reference internal" href="uranyl.html">16.3. Uranyl ion in solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="histo.html">16.4. Histogram</a></li>
</ul>
</li>
</ul>
<h3>Helpful Links</h3>
<p>Current version: <b>0.9.24</b></p>

<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/">Demeter homepage</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/bruceravel/demeter/">Demeter @ github</a>
<<<<<<< HEAD
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit @ github</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch homepage</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Athena/index.html">Athena manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/Artemis/index.html">Artemis manual</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/bugs.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.io/demeter/documents/SinglePage/help.html">How to ask a good question</a>
=======
  <li>&nbsp; &nbsp; <a href="https://github.com/newville/ifeffit">Ifeffit</a>
  <li>&nbsp; &nbsp; <a href="http://xraypy.github.io/xraylarch/">Larch</a>
  <li>&nbsp; &nbsp; <a href="http://xafs.org/">xafs.org</a>
</ul>
<ul>
  <li>&nbsp; &nbsp; <a href="http://cars9.uchicago.edu/mailman/listinfo/ifeffit/">Ifeffit mailing list</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.com/demeter/pods/bugs.pod.html">Bug reporting hints</a>
  <li>&nbsp; &nbsp; <a href="http://bruceravel.github.com/demeter/pods/help.pod.html">How to ask a good question</a>
>>>>>>> 753331e6a97ab20b2d74045d9da536a4dde339ea
</ul>
<p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/agau.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="uranyl.html" title="16.3. Uranyl ion in solution"
             >next</a></li>
        <li class="right" >
          <a href="methyltin.html" title="16.1. Methyltin chloride"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Demeter Programming Guide 0.9.24 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >16. Full examples</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Bruce Ravel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>