<!DOCTYPE HTMP PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Modeling disorder</title>
    <link rel="stylesheet" href=../artug.css />
    <link rel="stylesheet" href=../ppi.css />
    <meta http-equiv="Content-Type" content="text/html"; charset=iso-8859-15 />
    <meta name="robots" contents="all" />
  </head>

  <body>
    <div class=topbar>
  <div class=navbar>
  <a class=navhead href="../index.html">The Artemis Users' Guide</a>
  <table class=navtable>
    <tr>
      <td align=left>
        &laquo;<a class=navtable href="http://bruceravel.github.io/demeter/"><span class=programlink>DEMETER</span></a>&raquo; &nbsp;
        &laquo;<a class=navtable href="https://github.com/newville/ifeffit"><span class=programlink>IFEFFIT</span></a>&raquo; &nbsp;
        <!-- [&nbsp;<a class=navtable href="http://leonardo.phys.washington.edu/feff/wiki/index.php?title=FEFF_Documentation"><span class=programlink>FEFF</span></a>&nbsp;] &nbsp; -->
        &laquo;<a class=navtable href="http://xafs.org">xafs.org</a>&raquo; &nbsp;
	<!-- [&nbsp;<a class=navtable href="../demeter.pdf">PDF&nbsp;doc</a>&nbsp;] -->
      </td>
      <td align=right>
        Back: <a class=navtable href="../extended/delr.html" class="menu">Modeling bond length</a> &nbsp;&nbsp;
        &nbsp;&nbsp;
        Up: <a class=navtable href="../extended/index.html" class="menu">Extended topics</a> &nbsp;&nbsp;
        Next: <a class=navtable href="../extended/constraints.html" class="menu">Constraints and restraints</a>      </td>
    </tr>
  </table>
  </div>
</div>

<div class=sidebar>
  <a href="../diana.html"><img src=../../images/Artemis_logo.jpg
    width=90% border=0 alt='[Artemis logo]'></a>
  <br />
  <a href="../index.html"  class="menu">Home</a><br />
<a href="../intro.html"  class="menu">Introduction</a><br />
<a href="../startup/index.html"  class="menu">Starting Artemis</a><br />
<a href="../data.html"  class="menu">The Data window</a><br />
<a href="../feff/index.html"  class="menu">The Atoms/Feff window</a><br />
<a href="../path/index.html"  class="menu">The Path page</a><br />
<a href="../gds.html"  class="menu">The GDS window</a><br />
<a href="../fit/index.html"  class="menu">Running a fit</a><br />
<a href="../plot/index.html"  class="menu">The Plot window</a><br />
<a href="../logjournal.html"  class="menu">The Log & Journal windows</a><br />
<a href="../history.html"  class="menu">The History window</a><br />
<a href="../monitor.html"  class="menu">Monitoring things</a><br />
<a href="../prefs.html"  class="menu">Managing preferences</a><br />
<a href="../examples/index.html"  class="menu">Worked examples</a><br />
<a href="../atoms/index.html"  class="menu">Crystallography for EXAFS</a><br />
<a href="../extended/index.html"  class="menuselect">Extended topics</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/qfs.html"  class="menu">Quick first shell theory</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/cv.html"  class="menu">Characteristic value</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/delr.html"  class="menu">Modeling bond length</a><br />
&nbsp;&#8618;&nbsp;<span style="font-style: italic;">Modeling disorder</span><br />
&nbsp;&#8618;&nbsp;<a href="../extended/constraints.html"  class="menu">Constraints and restraints</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/bvs.html"  class="menu">Bond valence sums</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/empirical.html"  class="menu">Using empirical standards</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/ipots.html"  class="menu">Unique potentials</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/fuzzy.html"  class="menu">Fuzzy degeneracy</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/dopants.html"  class="menu">Handling dopants</a><br />
&nbsp;&#8618;&nbsp;<a href="../extended/fivesix.html"  class="menu">5 and 6 legged paths</a><br />
</div>

<div class=contentarea>


<h1>
  Modeling disorder
</h1>

<p>
The &sigma;&sup2; term in the EXAFS equation accounts for the mean square
variation in path length.  This variation can be due to thermal or
structural disorder.  Even in a well-ordered material, like Cu or
another FCC metal, data are measured at finite temperature.  The
absorber and scatterer are both in motion due to the finite
temperature.  Each interaction of the incident X-ray and the absorber
is like a femtosecond snapshot of the coordination environment.  As
those snapshots are averaged in the EXAFS measurement, &sigma;&sup2; is
non-zero, even in the well-ordered material.
</p>

<p>
A structural disordered contributes another term to &sigma;&sup2;.  Due
to structural disorder, the scatterers which are nominally contained
in a scattering shell may be centered around somehwat different
distances.  When the contributions from those scatterers are
considered, &sigma;&sup2; will be larger than what is expected from
purely thermal effects.
</p>

<p>
Consequently, &sigma;&sup2; is always non-zero in an EXAFS fit and a
proper interpretation of the fitted value of &sigma;&sup2; will take into
account both the thermal and structural component.
</p>

<p>
It is usually a challenge to distinguish the thermal and structural
contributions to &sigma;&sup2;.  As with any highly correlated effects,
the only way to disentangle the two contributions is to do something
in the experiment which is sensitive to one or both.
</p>

<p>
One common approach for understanding the thermal part of &sigma;&sup2; is
to measure the sample at two or more temperatures.  Assuming the
material does not change phase in that temperature range, we expect
the thermal part of &sigma;&sup2; to have a temperature dependence while
the structural part may reman fixed (or at least change much less).
Another possible way to disentangle the two contributions is to
measure EXAFS data as a function of pressure.  In that case the
thermal contribution can be modeled as a function of pressure and a
Gr&uuml;neisen parameter.
</p>



<hr class=hide />
<a name="debyeandeinsteinmodels">
<p>&nbsp;</p>
</a>

<h2>  Debye and Einstein models</h2>

<p>
<span class=program>IFEFFIT</span> provides two bult-in functions for modeling &sigma;&sup2; as
a function of temperature.
<dl>
  
<dt>
  Einstein model
</dt>
<dd>
The Einstein model assumes that the absorber and scatter are balls
connected by a quantum spring.  They oscillate with a single frequency
and the low-temperature motion saturates to a zero-point motion.  The
function for computing &sigma;&sup2; from the Einstein is a function of
the measurement temperature, an Einstein temperature, and the reduced
mass of the absorber/scatterer pair.  In <span class=program>ARTEMIS</span> one writes:
<pre>
path:
	sigma2 = eins(temperature, thetae)
</pre>
Typically, <tt>temeprature</tt> is a set parameter
whise value is the mesurement tempreature of the data and 
<tt>thetae</tt> is a guess parameter representing
the Einstein temprature &ndash; i.e. the characteristic frequency of
vibration expressed in temeprature units &ndash; of the
absorber-scatterer pair.  The reduced mass is computed by <span class=program>IFEFFIT</span>
from the information provided by <span class=program>FEFF</span> about the scattering path.
</p>

<p>
The Einstein function is most useful as part of a multiple data set
fit.  In that case, a path can have its &sigma;&sup2; parametrized using
the <tt>eins</tt> function and a single &Theta;<sub>E</sub>
guess parameter is used for all temperatures.
</p>

<p>
When using <span class=program>IFEFFIT</span>, the Einstein function is called 
<tt>eins()</tt>.  When using <span class=program>LARCH</span>, it is
called <tt>sigma2_eins()</tt>.  The user of
<span class=program>ARTEMIS</span> can use either form with either backend and the correct
thing will happen.
  <br />
  <br />
</dd>
<dt>
  Correlated Debye model
</dt>
<dd>
The correlated Debye model assumes that the &sigma;&sup2; for any pair of
atoms can be computed from the acoustic phonon spectrum.  That is, a
single charcteristic energy &ndash; the same Debye temperature,
, that is determined from the heat capacity of the material 
&ndash; can be used to compute &sigma;&sup2; for any path in the
material.  In <span class=program>ARTEMIS</span> one writes:
<pre>
path:
	sigma2 = debye(temperature, thetae)
</pre>
This is a very powerful concept.  All &sigma;&sup2; parameters in the fit
are determined from a single variable &Theta;<sub>D</sub>.
The caveat is that the correlated Debye model is only strictly valid
for a monoatomic material.  In practice, the Debye model works well
for metals like Cu, Au, and Pt.  It works poorly for any material that
has two or more atomic species.
</p>

<p>
When using <span class=program>IFEFFIT</span>, the Debye function is called 
<tt>debye()</tt>.  When using <span class=program>LARCH</span>, it is
called <tt>sigma2_debye()</tt>.  The user of
<span class=program>ARTEMIS</span> can use either form with either backend and the correct
thing will happen.
  <br />
  <br />
</dd>
</dl>
</p>

<p>
Both models are described in 
S. Sevillano, H. Meuth, and J.J. Rehr, <em>Phys. Rev.</em>, <strong>B20:12</strong>, 
(1979) p.&nbsp;4908-4911<a href="https://doi.org/10.1103/PhysRevB.20.4908"> (DOI: 10.1103/PhysRevB.20.4908)</a>.</p>


<hr class=hide />
<a name="collinearmultiplescatteringpaths">
<p>&nbsp;</p>
</a>

<h2>  Collinear multiple scattering paths</h2>

<p>

</td>
<td width=303>
<a class=floatright href="../../images/collinear.png"  title=The Artemis Users' Guide target=_blank><img border=0 src="../../images/collinear.png"  title="The Artemis Users' Guide"  alt="collinear.png"></a>A valuable paper by
E.A. Hudson et al., <em>Phys. Rev.</em>, <strong>B54:1</strong>, 
(1996) p.&nbsp;156-165<a href="https://doi.org/10.1103/PhysRevB.54.156"> (DOI: 10.1103/PhysRevB.54.156)</a> explains the relationships between &sigma;&sup2; parameters for single
scattering paths and certain multiple scattering paths.
</p>

<p>
The diagram to the right demonstrates the various kinds of collinear
MS paths and how they relate to the corresponding SS path.
</p>

<p>
To begin, we define guess parameters for the &sigma;&sup2; of the SS
paths to atoms 1 and 2.
<pre>
guess  ss1 = 0.003
guess  ss2 = 0.003
</pre>
The next two paths are double and triple scattering paths that
scatter in the forward direction from atom 1, then in the backward
direction atom 2.  As explained by Hudson, et al., these paths have
the same &sigma;&sup2; as the SS path to atom 2, i.e.
&sigma;&sup2;=<tt>ss2</tt> for both these paths.
</p>

<p>
The next three paths involve scattering from the absorber.  The
collinear DS and TS paths simply have 
&sigma;&sup2;=<tt>2*ss1</tt>.
The path in which the photoelectron rattles back
and forth between the absorber and atom 1 has
&sigma;&sup2;=<tt>4*ss1</tt>.
</p>

<p>
The caveat to these relationships is that the motion of the
intervening atom in the perpendicular direction is presumed to be a
negligible contribution to the mean square variation in path length.
This is, of course, not strictly true.  In very high quality data, you
may see deviations from the expressions presented by Hudson, et al.,
but in most cases they are an excellent approximation and a powerful
constraint that you can apply to the paths in your fit.
</p>

<hr class=hide />
<a name="sensibleapproximationsfortriangularmultiplescatteringpaths">
<p>&nbsp;</p>
</a>

<h2>  Sensible approximations for triangular multiple scattering paths</h2>

<p>
In <a href="../examples/fes2.html">the FeS2
example</a>, we saw that a couple of non-collinear multiple scattering paths
contributed significantly to the EXAFS.  For these triangular paths,
unlike for collinear paths, there is no obvious relationship between
their &sigma;&sup2; parameters and the &sigma;&sup2; for the SS paths.
</p>

<p>
One of the triangular paths in the FeS<sub>2</sub> fit was of the form 
Abs&rarr;Fe&rarr;S&rarr;Abs.  The S&rarr;Abs leg is like
half the first neighbor path.  The Fe&rarr;S is also like half the
first neighbor path.  The mean square vairation in path length along
those two legs of the path <strong>is</strong> the &sigma;&sup2;
for the first path.  FinallyThe Abs&rarr;Fe leg is like half the
fourth shell path. 
</p>

<p>
The math epression for the &sigma;&sup2; of this triangle path was set as
<pre>
path Fe-S triangle:
	sigma2 = ss1 + ss_fe/2
</pre>
This approximation of &sigma;&sup2; has the great virtue of not
introducing a new parameter to the fit.  It neglects any attenutation
to the path due to thermal variation in sattering angle.  While that
is an important effect, there is no simple and accurate way to model
it.
</p>

<p>
This example demonstrates the decision that must be made every time a
non-collinear multiple scattering path is considered for a fitting
model.  In short, you have three choices:
<ol>
  
<li><p>
Do nothing, leave the MS path out of the fit.
</p></li>
<li><p>
Include the MS path, but allow it to have it's own &sigma;&sup2;
parameter. 
</p></li>
<li><p>
Include the MS path, but approximate it's &sigma;&sup2; in terms of
parameters which are already part ofthe fitting model, presumably the
parameters of the SS &sigma;&sup2; values.
</p></li>
</ol>
</p>

<p>
The Abs&rarr;Fe&rarr;S&rarr;Abs path in FeS<sub>2</sub> was really
quite large.  Going for choice number 1 and leaving it out of the fit is
clearly a poor choice.
</p>

<p>
Number 2 is, in principle, the best choice.  As an independently floated
parameter, it's &sigma;&sup2; will account for the mean square
vriation in path length <strong>and</strong> the effect of
variation in t he scattering angle.  Unfortunately, this parameter is
likely not to be highly robust because it is only used for this one
path.  There just is not much information available to determine its
proper value.  And if the fit includes several triangle paths, each of
which has a &sigma;&sup2; parameter of similarly weak robustness, the
problem becomes amplified.
</p>

<p>
In almost all cases, option number 3 is the best choice.  The approximation
is not horribly wrong, thus it introduces only a little bit of
systematic error into the fitting model.  Including the Fourier
components from the path is better than neglecting the path.  Since a
reasonable approximation can be made without introducing new variable
parameters to the fit, the triangle path should be included.
</p>

<p>
The Abs&rarr;Fe&rarr;S&rarr;Abs path had the virtue that all
of its legs were represented by SS paths already included in the fit.
Another triangle path was included:
Abs&rarr;S&rarr;S&rarr;Abs.
In this case, the first and last legs are related to the first
coordination shell.  The middle leg, S&rarr;S, has no corresponding
SS path.  In <a href="../examples/fes2.html">the FeS2
example</a>, this triangle path was given a &sigma;&sup2; math expression
of 1.5 times the first shell &sigma;&sup2;.  
</p>

<p>
This is obviously not accurate.  Like all such triangle paths, the
decision outlined above must be worked through.  In this case, the fit
benefits by including this triangle path, but it does not merit having
its own floating parameter.  I assert that value of &sigma;&sup2; that is 
&ldquo;a bit more than the first shell&rdquo; is reasonable.
</p>

<p>
This is discussed in more detail in Scott Calvin's book, 
<a href="http://www.amazon.com/XAFS-Everyone-Scott-Calvin-ebook/dp/B00CUNBZA4">XAFS for Everyone</a>.
</p>

</div>

<br />
<hr class=hide />
<hr class=bottomdivider />

<div class=bottombar>
  <div class=copyright>
  <table>
    <tr>
      <td colspan=2>
        <span class=program>DEMETER</span> is copyright &copy; 2009-2015 Bruce Ravel
        &mdash;
        This document is copyright &copy; 2015 Bruce Ravel
        <br />
      </td>
    </tr>
    <tr valign=middle>
      <td> 
           <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../../images/somerights20.png" width="88" height="31" alt="" border="0" /></a> &nbsp;&nbsp;&nbsp;
      </td>
      <td>
  	This document is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">
  	The Creative Commons Attribution-ShareAlike License</a>.
  	<br />
  	If <span class=program>DEMETER</span> and this document are useful to you, please consider
  	<a href="http://creativecommons.org/support/">supporting The Creative Commons</a>.
      </td>
    </tr>
  </table>
</div>
</div>
  </body>
</html>